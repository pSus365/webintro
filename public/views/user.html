<?php
$pageTitle = "Stitch Design - Profil Użytkownika";
$extraStyles = ['/public/styles/user.css'];
include 'partials/header.php';
?>

<div class="page-header-row">
    <h1 class="page-title">Witaj,
        <?= $user['name'] ?>!
    </h1>
</div>

<div class="profile-container">
    <!-- Left: Profile Card -->
    <div class="profile-card">
        <div class="profile-avatar-lg" style="background-image: url('<?= $user['avatar_url'] ?>');">
        </div>
        <h2 class="profile-name">
            <?= $user['name'] . ' ' . $user['surname'] ?>
        </h2>
        <p class="profile-email">
            <?= $user['email'] ?>
        </p>

        <form action="/user/upload-avatar" method="POST" enctype="multipart/form-data">
            <div class="upload-btn-wrapper">
                <button class="btn-upload">Zmień zdjęcie</button>
                <input type="file" name="avatar" onchange="this.form.submit()" />
            </div>
        </form>
    </div>

    <!-- Right: Settings -->
    <div class="settings-card">
        <h3 class="section-title">Edytuj Profil</h3>
        <form action="/user/update" method="POST">
            <div class="form-group">
                <label class="form-label">Imię</label>
                <input type="text" name="name" class="form-input" value="<?= $user['name'] ?>">
            </div>
            <div class="form-group">
                <label class="form-label">Nazwisko</label>
                <input type="text" name="surname" class="form-input" value="<?= $user['surname'] ?>">
            </div>
            <!-- Readonly Email -->
            <div class="form-group">
                <label class="form-label">Email</label>
                <input type="email" class="form-input" value="<?= $user['email'] ?>" disabled
                    style="background-color: var(--bg-light); color: var(--text-muted);">
            </div>

            <button type="submit" class="btn-primary">Zapisz zmiany</button>
        </form>

        <h3 class="section-title" style="margin-top: 3rem;">Inne Opcje</h3>
        <form action="/user/password" method="POST">
            <div class="form-group">
                <label class="form-label">Nowe hasło</label>
                <input type="password" name="password" class="form-input" placeholder="Wpisz nowe hasło">
            </div>
            <div class="form-group">
                <label class="form-label">Potwierdź nowe hasło</label>
                <input type="password" name="repeatedPassword" class="form-input" placeholder="Powtórz nowe hasło">
            </div>
            <button type="submit" class="btn-primary" style="margin-bottom: 2rem;">Zmień hasło</button>
        </form>

        <div style="border-top: 1px solid var(--border-color); padding-top: 2rem;">
            <a href="/logout" class="btn-primary"
                style="background-color: var(--red-text); text-decoration: none; display: inline-block; text-align: center;">
                Wyloguj się
            </a>
        </div>
    </div>
</div>

<?php include 'partials/footer.php'; ?>