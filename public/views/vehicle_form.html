<?php
$pageTitle = "Fleet Manager - " . (($action === 'edit') ? 'Edytuj Pojazd' : 'Dodaj Pojazd');
include 'partials/header.php';
?>

<div class="page-header-row">
    <h1 class="page-title">
        <?= ($action === 'edit') ? 'Edycja Pojazdu' : 'Nowy Pojazd' ?>
    </h1>
    <a href="/vehicles" class="btn-primary" style="background-color: var(--text-muted); text-decoration: none;">
        Powrót
    </a>
</div>

<div class="table-container" style="padding: 2rem;">
    <form action="<?= ($action === 'edit') ? '/edit-vehicle' : '/add-vehicle' ?>" method="POST"
        style="max-width: 600px; margin: 0 auto; display: flex; flex-direction: column; gap: 1rem;">
        <?php if($action === 'edit'): ?>
        <input type="hidden" name="id" value="<?= $vehicle['id'] ?>">
        <?php endif; ?>

        <div style="display: flex; flex-direction: column; gap: 0.5rem;">
            <label style="font-weight: 500; font-size: 0.875rem;">Nazwa</label>
            <input type="text" name="name" required value="<?= $vehicle['name'] ?? '' ?>" class="search-input"
                style="padding-left: 1rem;">
        </div>

        <div style="display: flex; flex-direction: column; gap: 0.5rem;">
            <label style="font-weight: 500; font-size: 0.875rem;">Typ</label>
            <input type="text" name="type" required value="<?= $vehicle['type'] ?? '' ?>" class="search-input"
                style="padding-left: 1rem;">
        </div>

        <div style="display: flex; flex-direction: column; gap: 0.5rem;">
            <label style="font-weight: 500; font-size: 0.875rem;">Przebieg (km)</label>
            <input type="number" name="mileage" required value="<?= $vehicle['mileage'] ?? '' ?>" class="search-input"
                style="padding-left: 1rem;">
        </div>

        <div style="display: flex; flex-direction: column; gap: 0.5rem;">
            <label style="font-weight: 500; font-size: 0.875rem;">Następny Przegląd</label>
            <input type="date" name="next_service_date" required value="<?= $vehicle['next_service_date'] ?? '' ?>"
                class="search-input" style="padding-left: 1rem;">
        </div>

        <div style="display: flex; flex-direction: column; gap: 0.5rem;">
            <label style="font-weight: 500; font-size: 0.875rem;">Przewidywany koszt serwisu
                (PLN)</label>
            <input type="number" step="0.01" name="estimated_service_cost" required
                value="<?= $vehicle['estimated_service_cost'] ?? '' ?>" class="search-input"
                style="padding-left: 1rem;">
        </div>

        <div style="display: flex; flex-direction: column; gap: 0.5rem;">
            <label style="font-weight: 500; font-size: 0.875rem;">Status</label>
            <select name="status" class="search-input" style="padding-left: 1rem;">
                <option value="wolny" <?=(isset($vehicle['status']) && $vehicle['status']==='wolny' ) ? 'selected' : ''
                    ?>>Wolny</option>
                <option value="w trasie" <?=(isset($vehicle['status']) && $vehicle['status']==='w trasie' ) ? 'selected'
                    : '' ?>>W trasie</option>
                <option value="serwis" <?=(isset($vehicle['status']) && $vehicle['status']==='serwis' ) ? 'selected'
                    : '' ?>>Serwis</option>
            </select>
        </div>

        <button type="submit" class="btn-primary" style="margin-top: 1rem; width: 100%;">
            <?= ($action === 'edit') ? 'Zapisz zmiany' : 'Dodaj pojazd' ?>
        </button>
    </form>
</div>

<?php include 'partials/footer.php'; ?>