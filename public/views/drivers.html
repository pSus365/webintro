<?php
$pageTitle = "Stitch Design - Kierowcy";
$extraStyles = ['/public/styles/drivers.css'];
include 'partials/header.php';
?>

<div class="page-header-row">
    <h1 class="page-title">Kierowcy</h1>
    <a href="/add-driver" class="btn-primary" style="text-decoration: none;">
        <span class="material-symbols-outlined" style="font-size: 1.25rem;">add</span>
        <span>Dodaj kierowcę</span>
    </a>
</div>

<div class="controls-section">
    <form class="search-wrapper" action="/drivers" method="GET">
        <div class="search-icon">
            <span class="material-symbols-outlined">search</span>
        </div>
        <input class="search-input" name="search" placeholder="Szukaj kierowcy" type="text"
            value="<?= $search ?? '' ?>" />
        <?php if(isset($currentFilter) && $currentFilter !== 'all'): ?>
        <input type="hidden" name="filter" value="<?= $currentFilter ?>">
        <?php endif; ?>
    </form>

    <div class="tabs-wrapper">
        <a class="tab-link <?= (!isset($currentFilter) || $currentFilter === 'all') ? 'active' : '' ?>"
            href="/drivers?filter=all">Wszystkie</a>
        <a class="tab-link <?= (isset($currentFilter) && $currentFilter === 'active') ? 'active' : '' ?>"
            href="/drivers?filter=active">Aktywni</a>
        <a class="tab-link <?= (isset($currentFilter) && $currentFilter === 'inactive') ? 'active' : '' ?>"
            href="/drivers?filter=inactive">Nieaktywni</a>
    </div>
</div>

<div class="table-container">
    <div class="table-wrapper">
        <table class="vehicles-table">
            <thead>
                <tr>
                    <th>Imię</th>
                    <th>Nazwisko</th>
                    <th>Status</th>
                    <th>Adres</th>
                    <th>Data Zatrudnienia</th>
                    <th>Akcje</th>
                </tr>
            </thead>
            <tbody>
                <?php if(isset($drivers)): ?>
                <?php foreach ($drivers as $driver): ?>
                <tr>
                    <td class="text-dark font-medium">
                        <?= $driver['first_name']; ?>
                    </td>
                    <td>
                        <?= $driver['last_name']; ?>
                    </td>
                    <td>
                        <span class="status-badge <?= strtolower(str_replace(' ', '-', $driver['status'])); ?>">
                            <?= $driver['status']; ?>
                        </span>
                    </td>
                    <td>
                        <?= $driver['city'] . ', ' . $driver['street'] . ' ' . $driver['house_number']; ?>
                    </td>
                    <td>
                        <?= $driver['employment_date']; ?>
                    </td>
                    <td style="display: flex; gap: 0.5rem; white-space: nowrap;">
                        <a class="action-btn edit" href="/edit-driver?id=<?= $driver['id']; ?>">Edytuj</a>
                        <form action="/delete-driver" method="POST"
                            onsubmit="return confirm('Czy na pewno chcesz usunąć tego kierowcę?');"
                            style="display: inline;">
                            <input type="hidden" name="id" value="<?= $driver['id']; ?>">
                            <button type="submit" class="action-btn delete">Usuń</button>
                        </form>
                    </td>
                </tr>
                <?php endforeach; ?>
                <?php endif; ?>
            </tbody>
        </table>
    </div>
</div>

<?php include 'partials/footer.php'; ?>